<p>Процесс обновления Evo состоит из почти тех же самых шагов, что и процесс установки. Но с одним серьезным исключением. А именно, при обновлении вы <em>не удаляете и не перезаписываете конфигурационный файл config.inc.php</em> на вашем сервере. Эти шаги следующие:</p>
<ol>
  <li>
    <p>Если вы изменили какие-либо сниппеты или плагины, поставляемые по умолчанию, то либо заранее их переименуйте, либо, когда в процессе работы мастера установки вы доберетесь до шага, на котором вас спросят, какие сниппеты и плагины установить, отключите соответствующие им флажки. Дело в том, что в процессе обновления все сниппеты, поставляемые по умолчанию, перезаписываются, чтобы гарантировать наличие у вас их последних версий. Поэтому, если вы внесли какие-то изменения в любой из сниппетов, поставляемых вместе с ядром Evo, и не хотите, чтобы в процессе обновления произошла его перезапись, то рекомендуется сохранить этот сниппет под другим именем.</p>
  </li>
  <li>
    <p>Сделайте резервную копию вашего сайта. Для этого скачайте все файлы с сервера на ваш компьютер с помощью FTP-клиента, а затем с помощью утилиты phpMyAdmin (или любой другой утилиты для работы с базами данных) создайте дамп всей базы данных, используемой вашим сайтом, и тоже сохраните его на вашем компьютере.</p>
  </li>
  <li>
    <p>Убедитесь, что вы все сохранили в резервной копии! Да-да, серьезно!</p>
  </li>
  <li>
    <p>Скачайте и распакуйте zip-архив с новой версией Evo.</p>
  </li>
  <li>
    <p>Загрузите содержимое папки, которую вы распаковали из архива, на сервер. При этом все старые файлы следует просто перезаписать. Вообще-то, архив с дистрибутивом Evo не должен содержать конфигурационный файл config.inc.php в папке /manager/includes/, поэтому он не должен перезаписаться. Однако все-таки не будет лишним перед загрузкой файлов на сервер проверить, что конфигурационного файла в дистрибутиве нет, а также убедиться, что вы сохранили ваш текущий конфигурационный файл config.inc.php в резервной копии (вы же не забыли создать резервную копию, да?).</p>
  </li>
  <li>
    <p>Теперь запустите ваш веб-браузер и загрузите в нем скрипт index.php, находящийся в папке /install/.</p>
  </li>
  <li>
    <p>Следуйте шагам мастера установки. На этот раз, сразу же после принятия лицензионного соглашения следует выбрать опцию <strong><em>Обновить</em></strong>.</p>
    <div class="info">Замечание: Если ваша версия MySQL более старая, чем 4.1, выберите опцию Расширенное Обновление и установите кодировку, используемую при соединении, как cp1251_koi8, так как в версиях MySQL до 4.1 единственное разрешенное значение настройки charset_name &ndash; это cp1251_koi8. Хотя, вообще говоря, добавить новую кодировку можно посредством редактирования файла sql/convert.cc в исходном коде MySQL, так что использование других кодировок тоже возможно.</div>
  </li>
  <li>
    <p>Если вы удалили ваши старые файлы вместо того, чтобы их перезаписать, вам может понадобиться изменить права доступа к файлам и папкам, указанным в <a href="documentation/getting-started/basic-installation">руководстве по установке</a>, чтобы разрешить к ним для сервера доступ для записи, однако, если в этом возникнет необходимость, мастер установки вам об этом сообщит.</p>
  </li>
  <li>
    <p>На соответствующем шаге мастера установки не забудьте отключить флажки для тех ресурсов, которые вы изменили, если вы их не переименовали заранее.</p>
  </li>
  <li>
    <p>Как только вы доберетесь до шага мастера установки, где находится флажок, предлагающий удалить папку /install/, убедитесь, что этот флажок включен (это предотвратит повторный запуск процесса установки или обновления кем-нибудь другим, что может причинить ущерб вашему сайту).</p>
  </li>
  <li>
    <p>После того, как вы завершили работу мастера установки, снова зайдите на ваш сервер через FTP и проверьте, что папка /install/ удалена. Если это не так, удалите ее вручную.</p>
  </li>
  <li>
    <p>Ну и наконец, восстановите доступ только для чтения у вашего конфигурационного файла config.inc.php в папке /manager/includes/. Если вы заранее записали значение прав доступа, установите его, или же попробуйте установить значение 444. Это <em>реально важно</em>, так как это поможет защитить ваш сайт от взлома.</p>
  </li>
  <li>
    <p>Завершите работу мастера обновления.</p>
  </li>
  <li>
    <p>Как только у вас все снова будет работать, зайдите в админку Evo и подправьте имена ваших плагинов и сниппетов, если вы там что-то меняли на шаге 1.</p>
  </li>
  <li>
    <p>Теперь все сделано. Вы только что обновили Evo.</p>
  </li>
</ol>
<h3>Альтернативный способ</h3>
<p>При загрузке новой версии Evo поверх старой у вас могут остаться старые файлы, которые больше не используются. Каждый из членов команды разработки Evo предпочитает свой способ обновления, какой ему нравится, но здесь будет приведен способ с минимальным временем недоступности сайта:</p>
<ol>
  <li>
    <p>Скачайте все файлы с вашего сайта.</p>
  </li>
  <li>
    <p>Создайте резервную копию вашей базы данных.</p>
  </li>
  <li>
    <p>Вообще, создайте резервную копию старой версии вашего сайта, чтобы потом в случае необходимости ее можно было восстановить.</p>
  </li>
  <li>
    <p>Создайте новую <strong>локальную</strong> папку и назовите ее, допустим, EvoNew (или как вам больше нравится).</p>
  </li>
  <li>
    <p>Извлеките файлы новой версии Evo в эту папку.</p>
  </li>
  <li>
    <p>Из созданной вами резервной копии скопируйте конфигурационный файл config.inc.php в папку /manager/includes/.</p>
  </li>
  <li>
    <p>Скопируйте все сниппеты, модули, плагины и прочие подобные компоненты, которые вам нужны или которые вы изменили, в соответствующие части папки EvoNew.</p>
  </li>
  <li>
    <p>Скопируйте все изображения, файлы css, файлы шаблонов, документы и тому подобное в соответствующие части папки EvoNew.</p>
  </li>
  <li>
    <p>Переименуйте новые папки и файлы в index.php-new, /manager-new/ и /assets-new/. Папку /install/ НЕ переименовывайте. Загрузите на сервер эти папки (в том числе папку /install/) и файл index.php-new. Это займет определенное время.</p>
  </li>
  <li>
    <p>Теперь переименуйте уже существующие на вашем сайте файлы и папки в index.php-old, /manager-old/ и /assets-old/.</p>
  </li>
  <li>
    <p>Начиная с этого момента, ваш сайт не работает.</p>
  </li>
  <li>
    <p>Переименуйте новые папки и файлы в index.php, /manager/ и /assets/.</p>
  </li>
  <li>
    <p>Запустите из вашего браузера скрипт yoursite.com/install, после чего выберите опцию Обновить. Подробности смотрите в <a href="documentation/getting-started/basic-installation">руководстве по установке</a>.</p>
    <div class="info">Замечание: Если ваша версия MySQL более старая, чем 4.1, выберите опцию Расширенное Обновление и установите кодировку, используемую при соединении, как cp1251_koi8, так как в версиях MySQL до 4.1 единственное разрешенное значение настройки charset_name &ndash; это cp1251_koi8. Хотя, вообще говоря, добавить новую кодировку можно посредством редактирования файла sql/convert.cc в исходном коде MySQL, так что использование других кодировок тоже возможно.</div>
  </li>
  <li>
    <p>Начиная с этого момента, ваш сайт должен снова работать. Если же он не работает, переименуйте папки обратно!</p>
  </li>
  <li>
    <p>Если вы все сделали правильно, теперь можно удалить все папки с -old.</p>
  </li>
  <li>
    <p>Вам также следует сделать локальную резервную копию старой версии сайта и локальную резервную копию новой версии сайта.</p>
  </li>
</ol>
