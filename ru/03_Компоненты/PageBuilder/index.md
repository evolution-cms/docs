Автор: <a href="https://github.com/mnoskov/pagebuilder">mnoskov</a>

<img src="https://img.shields.io/badge/PHP-%3E=5.6-green.svg?php=5.6">

Плагин позволяет разработчику определить набор блоков с определенной разметкой и списком полей, чтобы контент-менеджер использовал те блоки, которые считает нужным, со своим наполнением.

После установки нужно создать файлы конфигурации, либо переименовать файлы `*.php.sample` в `*.php`. В панели администрирования плагин добавляет новую вкладку на странице редактирования ресурса. Для вывода результатов используется сниппет `[[PageBuilder]]`.

Конфигурация для блоков берется из папки `config`. Для создания нового блока нужно создать в этой папке файл `<имя конфига>.php`, который должен вернуть ассоциативный массив. Для создания контейнера нужно создать файл `container.<имя контейнера>.php`. Структура массива следующая:

<table>
<tr><th>Ключ</th><th>Значение</th></tr>
<tr><td>title</td><td>Название блока, видимое менеджеру при заполнении</td></tr>
<tr><td>container</td><td>Имя контейнера (если несколько - то массив имен), в котором будет выводится блок.</td></tr>
<tr>
<td>fields</td>
<td>
Ассоциативный массив используемых полей, в котором ключами являются идентификаторы полей, а значениями - массивы опций этих полей.

Возможные типы полей и опции приведены ниже.
</td>
</tr>
<tr><td>show_in_templates</td><td>Массив идентификаторов шаблонов, для которых доступны редактирование и вывод блоков</td></tr>
<tr><td>hide_in_docs</td><td>Массив идентификаторов документов, для которых редактирование и вывод недоступны</td></tr>
<tr><td>show_in_docs</td><td>Массив идентификаторов документов, для которых доступны редактирование и вывод блоков.

Если этот параметр указан, то `hide_in_docs` не принимается во внимание.

Если не указан ни один из параметров, ограничивающих доступ, блоки будут доступны во всех документах.</td></tr>
<tr><td>order</td><td>Порядок сортировки в секции добавления блока, либо порядок сортировки контейнеров (вкладок). Этот параметр НЕ влияет на сортировку самих блоков!</td></tr>
<tr>
<td>templates</td>
<td>

Ассоциативный массив, содержащий шаблон для ключа `owner`, а также шаблоны для каждой группы полей.

Описание методов создания шаблонов смотрите <a href="01_%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D1%8B.md">здесь</a>.

</td>
</tr>
<tr><td>icon</td><td>
  
  Класс иконки, который будет выводиться в секции для добавления нового блока, если в параметрах плагина значение `&addType` установлено в `icons`
  
Например, если задать класс `fa fa-cogs`, то в интерфейс будет выведено следующее:
```html
<i class="fa fa-cogs"></i>
```

</td></tr>
<tr><td>image</td><td>
  
  Изображение, которое будет выводиться в секции для добавления нового блока, если в параметрах плагина значение `&addType` установлено в `images`.
  
Изображение будет обработано сниппетом `phpthumb` с параметром `w=80`

</td></tr>
<tr><td>prepare</td><td>Имя сниппета либо функция, которая будет вызвана перед выводом данных. Например:

```php
'prepare' => function(&$options, &$values) {
  ...
},
```

Параметры для функции и сниппета одинаковые: `options` - конфигурация контейнера, `values` - значения полей.</td></tr>
</table>
